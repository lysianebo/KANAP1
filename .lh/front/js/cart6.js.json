{
    "sourceFile": "front/js/cart6.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 12,
            "patches": [
                {
                    "date": 1676931389668,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1676988960095,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,4 +1,5 @@\n+\n panier = getPanier\n  function getPanier(){\n      let panier = localStorage.getItem(\"panier\")\n     if(panier == null){\n"
                },
                {
                    "date": 1676988972918,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,6 @@\n \n-panier = getPanier\n+let panier = getPanier\n  function getPanier(){\n      let panier = localStorage.getItem(\"panier\")\n     if(panier == null){\n         return []\n"
                },
                {
                    "date": 1676989057414,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,9 +9,9 @@\n    }\n }\n \n const cart = []\n-const item = localStorage.getItem(localStorage.panier) || \"\"\n+const item = localStorage.getItem(localStorage) || \"\"\n \n retrieveItemsFromCache()\n cart.forEach(() => makeArticle())\n //cart.forEach((item) => displayItem(item))\n"
                },
                {
                    "date": 1676989090373,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,9 +8,9 @@\n        return JSON.parse(panier)\n    }\n }\n \n-const cart = []\n+//const cart = []\n const item = localStorage.getItem(localStorage) || \"\"\n \n retrieveItemsFromCache()\n cart.forEach(() => makeArticle())\n"
                },
                {
                    "date": 1676989125560,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,9 +12,9 @@\n //const cart = []\n const item = localStorage.getItem(localStorage) || \"\"\n \n retrieveItemsFromCache()\n-cart.forEach(() => makeArticle())\n+panier.forEach(() => makeArticle())\n //cart.forEach((item) => displayItem(item))\n function retrieveItemsFromCache() {\n     const numberofItems = localStorage.length\n     for (let i = 0; i < numberofItems; i++) {\n"
                },
                {
                    "date": 1676989144722,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,9 +13,9 @@\n const item = localStorage.getItem(localStorage) || \"\"\n \n retrieveItemsFromCache()\n panier.forEach(() => makeArticle())\n-//cart.forEach((item) => displayItem(item))\n+cart.forEach((item) => displayItem(item))\n function retrieveItemsFromCache() {\n     const numberofItems = localStorage.length\n     for (let i = 0; i < numberofItems; i++) {\n     const item = localStorage.getItem(localStorage.key(i)) || \"\"\n"
                },
                {
                    "date": 1676989198162,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,9 +13,9 @@\n const item = localStorage.getItem(localStorage) || \"\"\n \n retrieveItemsFromCache()\n panier.forEach(() => makeArticle())\n-cart.forEach((item) => displayItem(item))\n+PA.forEach((item) => displayItem(item))\n function retrieveItemsFromCache() {\n     const numberofItems = localStorage.length\n     for (let i = 0; i < numberofItems; i++) {\n     const item = localStorage.getItem(localStorage.key(i)) || \"\"\n"
                },
                {
                    "date": 1676989217720,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,9 +13,9 @@\n const item = localStorage.getItem(localStorage) || \"\"\n \n retrieveItemsFromCache()\n panier.forEach(() => makeArticle())\n-PA.forEach((item) => displayItem(item))\n+//panier.forEach((item) => displayItem(item))\n function retrieveItemsFromCache() {\n     const numberofItems = localStorage.length\n     for (let i = 0; i < numberofItems; i++) {\n     const item = localStorage.getItem(localStorage.key(i)) || \"\"\n"
                },
                {
                    "date": 1676989232862,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,10 +12,10 @@\n //const cart = []\n const item = localStorage.getItem(localStorage) || \"\"\n \n retrieveItemsFromCache()\n-panier.forEach(() => makeArticle())\n-//panier.forEach((item) => displayItem(item))\n+panier.forEach(() => makeArticle(item))\n+panier.forEach((item) => displayItem(item))\n function retrieveItemsFromCache() {\n     const numberofItems = localStorage.length\n     for (let i = 0; i < numberofItems; i++) {\n     const item = localStorage.getItem(localStorage.key(i)) || \"\"\n"
                },
                {
                    "date": 1676989253258,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,9 +17,9 @@\n panier.forEach((item) => displayItem(item))\n function retrieveItemsFromCache() {\n     const numberofItems = localStorage.length\n     for (let i = 0; i < numberofItems; i++) {\n-    const item = localStorage.getItem(localStorage.key(i)) || \"\"\n+    //const item = localStorage.getItem(localStorage.key(i)) || \"\"\n     const itemObjet = JSON.parse(item)\n     cart.push(itemObjet)\n     }\n }\n"
                },
                {
                    "date": 1676989264096,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,9 +17,9 @@\n panier.forEach((item) => displayItem(item))\n function retrieveItemsFromCache() {\n     const numberofItems = localStorage.length\n     for (let i = 0; i < numberofItems; i++) {\n-    /const item = localStorage.getItem(localStorage.key(i)) || \"\"\n+    const item = localStorage.getItem(localStorage.key(i)) || \"\"\n     const itemObjet = JSON.parse(item)\n     cart.push(itemObjet)\n     }\n }\n"
                },
                {
                    "date": 1676990480291,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,9 @@\n const apiData = fetch(`http://localhost:3000/api/products/`)\n \n apiData\n    .then(responseData) => {\n-    console.log(reponse)\n+    console.log(reponseD)\n    const response = responseData.json()\n     .then((res) => getData(res)) \n  \n \n"
                }
            ],
            "date": 1676931389668,
            "name": "Commit-0",
            "content": "panier = getPanier\n function getPanier(){\n     let panier = localStorage.getItem(\"panier\")\n    if(panier == null){\n        return []\n   }else{\n       return JSON.parse(panier)\n   }\n}\n\nconst cart = []\nconst item = localStorage.getItem(localStorage.panier) || \"\"\n\nretrieveItemsFromCache()\ncart.forEach(() => makeArticle())\n//cart.forEach((item) => displayItem(item))\nfunction retrieveItemsFromCache() {\n    const numberofItems = localStorage.length\n    for (let i = 0; i < numberofItems; i++) {\n    const item = localStorage.getItem(localStorage.key(i)) || \"\"\n    const itemObjet = JSON.parse(item)\n    cart.push(itemObjet)\n    }\n}\nfunction displayItem(){\n    const article = makeArticle()\n   const image = makeImageDiv()\n    const content = makeContentDiv()\n   appendtoArticle(article, [content])\n\n   addProducts()\n\n\n}\n\n\nmakeArticle(item)\n\nfunction makeArticle(item){\n    const addArticle = document.createElement(\"article\")\n    addArticle.classList.add(\"cart__item\")\n    addArticle.dataset.id = item.id\n    addArticle.dataset.color = item.color\n    document.getElementById(\"cart__items\").appendChild(addArticle)\n\n        const divImg = document.createElement(\"div\")\n        divImg.classList.add(\"cart__item__img\")\n        const image = document.createElement(\"img\")\n      image.src = item.imgUrl\n      image.alt = item.altTxt\n        divImg.appendChild(image)\n        \n        const contentDiv = document.createElement('div')\n        contentDiv.classList.add(\"cart__item__content\")\n\n            const descriptionDiv = document.createElement(\"div\")\n            descriptionDiv.classList.add(\"cart__item__content__description\")\n            \n            const h2= document.createElement(\"h2\")\n            h2.textContent = item.name\n            const p = document.createElement(\"p\")\n            p.textContent = item.color\n            const p2 = document.createElement(\"p\")\n            p2.textContent = item.price + \"€\"\n\n            const settingsDiv = document.createElement(\"div\")\n            settingsDiv.classList.add(\"cart__item__content__settings\")\n                const quantity = document.createElement(\"div\")\n                quantity.classList.add(\"cart__item__content__settings__quantity\")\n                    const quantityP = document.createElement(\"p\")\n                    quantityP.textContent =\"Qté : \"\n                    const input = document.createElement(\"input\")\n                    input.type = \"number\"\n                    input.classList.add(\"itemQuantity\")\n                    input.name =\"itemQuantity\"\n                    input.min =\"1\"\n                    input.max =\"100\"\n                    input.value = panier.quantity\n                    input.addEventListener(\"input\", (e) => updatePriceQuantity(panier.id, input.value, panier)) \n                const contentDelete = document.createElement(\"div\")\n                contentDelete.classList.add(\"cart__item__content__settings__delete\")\n                    const deleteP = document.createElement(\"p\")\n                    deleteP.classList.add(\"deleItem\")\n                    deleteP.textContent =\"Supprimer \"\n                    \n                   // p.addEvenListener(\"click\", () => deleteItem(item))\n                    //DeleteToSettings()\n                    //const Delete = DeleteToSettings()\n\n             \n        appendtoArticle(addArticle, [divImg, contentDiv])\n        appendtoArticle(contentDiv, [descriptionDiv, settingsDiv])\n        appendtoArticle(settingsDiv, [quantity, contentDelete])\n\n        appendtoArticle(descriptionDiv, [h2, p, p2])\n        appendtoArticle(quantity, [quantityP, input])\n        appendtoArticle(contentDelete, [deleteP])\n\n        displayTotalQuantity()\n        displayTotalPrice()\n}\n\nfunction appendtoArticle(article, array) {\n    array.forEach(item => {\n    article.appendChild(item)\n})\n}\nfunction displayTotalPrice(){\n    const totalPrice = document.querySelector(\"#totalPrice\")\n    //const total = cart.reduce((total,item) => total + item.price * item.quantity, 0)\n    //totalPrice.textContent = total\n    const total = totalPrice.textContent\n }\n function displayTotalQuantity(){\n    const totalQuantity = document.querySelector(\"#totalQuantity\")\n   // const total = cart.reduce((total,item) => total + item.quantity, 0)\n    //totalQuantity.textContent = total\n    const total = totalQuantity.textContent\n }\n function updatePriceQuantity(id, newValue, item){\n    const itemToUpdate = cart.find((item) => item.id === id)\n    itemToUpdate.quantity = Number(newValue)\n    item.quantity = itemToUpdate.quantity\n    displayTotalQuantity()\n    displayTotalPrice()\n    deleteDataFromCache(item)\n }\nfunction saveNewDataToCache(item){\n    const dataToSave = JSON.stringify(item)\n    const key = id//`${item.id}-${item.color}`\n    localStorage.setItem(key, dataToSave)\n}\nfunction DeleteToSettings(settings, item) {\n   const supprimer = document.querySelector(\".deleteItem\")\n   supprimer.addEventListener(\"click\", deleteDataFromCache)\n   // const itemTodelete = cart.findIndex((product) =>\n   // product.id === item.id && product.color === item.color)\n    cart.splice[itemToDelete, 1]\n    displayTotalQuantity()\n    displayTotalPrice\n    deleteDataFromCache(item)\n}\nfunction deleteDataFromCache(item){\nconst key = id //`${item.id}-${item.color}`\nlocalStorage.removeItem(key)\n}\n//console.log(cart)\nconst orderButton = document.querySelector(\"#order\")\norderButton.addEventListener(\"click\", (e) => submitForm(e))\n\nfunction submitForm(e){\ne.preventDefault() //ne pas rafraîchir\nif (cart.lenght === 0) alert (\"Sélectionnez votre canapé\")\n//return\n\n//if (formIsInvalid()) return\nif (emailIsInvalid()) return\n\nconst body = makeRequestBody()\nfetch(\"http://localhost:3000/api/products/order\",{\nmethod : \"POST\",\nbody: JSON.stringify(body),\nHeaders:{\n    \"Content-type\":\"appplication/json\"\n}\n})\n.then((res) => res.json())\n.then((data) => {\nconst orderId = data.orderId\nwindow.location.href = \"confirmation.html\" + \"?orderId=\" + orderId\n})\n.catch((err) => console.error(err))\n}\nfunction formIsInvalid(){\n   // const form = document.querySelector(\"cart__order__form\")\n   const inputs = form.querySelectorAll(\"input\")\n    inputs.forEach((input) =>{\n        if (input.value === \"\"){\n            alert(\"Vous devez compléter ce champ\")\n            return true\n        }\n        return false\n    })\n}\nfunction emailIsInvalid(){\n    const email = document.querySelector(\"#email\").value\n    const regex = /^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/\n    if (regex.test(email) === false) {\n        alert (\"Votre adresse mail n'est pas valide\")\n        return true\n    }\n    return false\n}\n\n\nfunction makeRequestBody(){\n    const form = document.querySelector(\"cart__order__form\")\n    inputFirstame = document.getElementById(\"firstName\").value;\n    inputLastname = document.getElementById(\"lastName\").value;\n    inputAddress = document.getElementById(\"address\").value;\n    inputCity = document.getElementById(\"city\").value;\n    inputEmail = document.getElementById(\"email\").value;\n\n    const body = {\n    contact: {\n        firstName: firstName,\n        lastName: lastName,\n        address: address,\n        city: city,\n        email: email\n      }\n      //  products: getIdsFromCache()\n    }\n    return body\n}\n//pas besoin de faire split si seulement key et pas color\nfunction getIdsFromCache(){\n    const numberOfProducts = localStorage-length\n    const ids = []\n    for (let i = 0; i < numberOfProducts; i++){\n    const key = localStorage.key(i)\n    const id = key-split(\"-\")[0]\n    //const id = key-split(\"-\")[0]\n\n    ids.push(id)\n    }\n    return ids\n}\n"
        }
    ]
}